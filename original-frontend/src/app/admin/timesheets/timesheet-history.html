<div class="timesheet-history-container">
  <div class="header">
    <h1>My Timesheets</h1>
  </div>

  <section class="filters-card">
    <div class="filter-group">
      <label>
        From
        <input type="date" [(ngModel)]="filters.date_from" name="historyFrom" />
      </label>
      <label>
        To
        <input type="date" [(ngModel)]="filters.date_to" name="historyTo" />
      </label>
    </div>
    <div class="filter-actions">
      <button type="button" class="btn primary" (click)="applyFilters()">Apply</button>
      <button type="button" class="btn" (click)="clearFilters()">Reset</button>
      <label class="toggle">
        <input type="checkbox" [(ngModel)]="showApproved" (change)="applyFilters()" />
        <span>Show Approved</span>
      </label>
    </div>
  </section>

  <div *ngIf="errorMessage" class="alert alert-error">{{ errorMessage }}</div>

  <div class="history-table">
    <table>
      <thead>
        <tr>
          <th>ID</th>
          <th>Date</th>
          <th>Status</th>
          <th>Total Minutes</th>
          <th>Location</th>
          <th>Notes</th>
          <th>Employee Sig</th>
          <th>Manager Sig</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let sheet of timesheets">
          <td>{{ sheet.timesheet_id }}</td>
          <td>{{ sheet.work_date }}</td>
          <td><span class="status-tag status-{{ sheet.status }}">{{ sheet.status | titlecase }}</span></td>
          <td>{{ sheet.total_minutes ?? 'N/A' }}</td>
          <td>{{ sheet.location || 'N/A' }}</td>
          <td>{{ sheet.notes || 'N/A' }}</td>
          <td>{{ sheet.has_employee_signature ? 'Yes' : 'No' }}</td>
          <td>{{ sheet.has_manager_signature ? 'Yes' : 'No' }}</td>
        </tr>
        <tr *ngIf="!timesheets.length && !isLoading">
          <td colspan="8" class="muted">No timesheets found.</td>
        </tr>
      </tbody>
    </table>
    <div *ngIf="isLoading" class="loading">Loading timesheets...</div>
    <div *ngIf="meta" class="list-meta">
      Total: {{ meta.total }} | Page {{ meta.page }} / {{ meta.totalPages }}
    </div>
    <div *ngIf="meta && meta.totalPages > 1" class="pagination">
      <button type="button" class="btn" (click)="prevPage()" [disabled]="currentPage <= 1">Previous</button>
      <span>Page {{ currentPage }} of {{ meta.totalPages }}</span>
      <button type="button" class="btn" (click)="nextPage()" [disabled]="meta && currentPage >= meta.totalPages">Next</button>
    </div>
  </div>
</div>

