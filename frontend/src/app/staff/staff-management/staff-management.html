<div class="staff-management-container">
  <app-staff-header title="Staff Info">
  </app-staff-header>

  <!-- ✅ My Profile -->
  <div class="my-profile-card">
    <h2>My Profile</h2>

    <!-- Loading -->
    <div *ngIf="isLoadingProfile" class="loading">Loading profile...</div>

    <!-- Error / feedback -->
    <div *ngIf="!isLoadingProfile && profileMessage" class="alert alert-error">
      {{ profileMessage }}
    </div>

    <!-- Summary (loaded & not editing) -->
    <div
      class="profile-summary"
      *ngIf="!isLoadingProfile && currentUser && !isEditingProfile"
    >
      <p><strong>Name:</strong> {{ currentUser.real_name || currentUser.user_name }}</p>
      <p><strong>Email:</strong> {{ currentUser.email || 'N/A' }}</p>
      <p><strong>Office:</strong> {{ currentUser.office_location || 'N/A' }}</p>

      <button type="button" class="btn primary" (click)="editMyProfile()">Edit My Info</button>
    </div>

    <!-- Edit form (loaded & editing) -->
    <div
      class="profile-edit-form"
      *ngIf="!isLoadingProfile && currentUser && isEditingProfile"
    >
      <label>Name:</label>
      <input type="text" [(ngModel)]="editProfileForm.name" />

      <label>Email:</label>
      <input type="email" [(ngModel)]="editProfileForm.email" />

      <label>Office Location:</label>
      <input type="text" [(ngModel)]="editProfileForm.officeLocation" />

      <label>New Password:</label>
      <input
        type="password"
        [(ngModel)]="editProfileForm.password"
        placeholder="Leave blank to keep current password"
      />

      <div class="form-actions">
        <button
          type="button"
          class="btn primary"
          (click)="saveMyProfile()"
          [disabled]="isSavingProfile"
        >
          Save
        </button>
        <button type="button" class="btn" (click)="cancelEditMyProfile()">Cancel</button>
      </div>
    </div>
  </div>

  <hr />

  <!-- ====== Staff list（已移除 Action 欄） ====== -->
  <div *ngIf="isLoading" class="loading">
    Loading staff...
  </div>

  <table *ngIf="!isLoading && staffList.length">
    <thead>
      <tr>
        <th>#</th>
        <th>Name</th>
        <th>Email</th>
        <th>Office</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let staff of staffList">
        <td>{{ staff.id }}</td>
        <td>{{ staff.name }}</td>
        <td>{{ staff.email }}</td>
        <td>{{ staff.officeLocation || 'N/A' }}</td>
      </tr>
    </tbody>
  </table>

  <div *ngIf="!isLoading && !staffList.length" class="empty-state">
    No staff records found.
  </div>
</div>
