<div class="daily-report-form-container">
  <div class="header">
    <h1>Create Daily Report</h1>
    <button type="button" class="btn secondary" (click)="navigateToList()">View Reports</button>
  </div>

  <form (ngSubmit)="submit()" class="form-card" novalidate>
    <div class="form-grid">
      <label>
        Date
        <input type="date" [(ngModel)]="reportDate" name="reportDate" required />
      </label>
      <label>
        Start Time
        <input type="time" [(ngModel)]="startTime" name="startTime" />
      </label>
      <label>
        End Time
        <input type="time" [(ngModel)]="endTime" name="endTime" />
      </label>
      <label>
        Staff Member
        <select [(ngModel)]="staffUserId" name="staffUser" required>
          <option value="">Select staff</option>
          <option *ngFor="let option of staffOptions" [value]="option.user_id">
            {{ option.display }}
          </option>
        </select>
      </label>
      <label>
        Staff Name (override)
        <input type="text" [(ngModel)]="staffName" name="staffName" placeholder="Optional" />
      </label>
    </div>

    <section class="clients-section">
      <h2>Clients</h2>
      <div
        class="client-card"
        *ngFor="let client of clients; let i = index"
      >
        <div class="client-header">
          <h3>Client {{ i + 1 }}</h3>
          <button type="button" class="btn link" (click)="removeClient(i)" *ngIf="clients.length > 1">
            Remove Client
          </button>
        </div>

        <label>Client Name
          <input [(ngModel)]="client.client_name" name="clientName{{ i }}" />
        </label>
        <label>Details
          <textarea [(ngModel)]="client.details" name="clientDetails{{ i }}"></textarea>
        </label>
        <label>Notes
          <textarea [(ngModel)]="client.notes" name="clientNotes{{ i }}"></textarea>
        </label>
        <label>Action Required
          <textarea [(ngModel)]="client.action_required" name="clientAction{{ i }}"></textarea>
        </label>
        <label>Status
          <select [(ngModel)]="client.status" name="clientStatus{{ i }}">
            <option value="Not Solved">Not Solved</option>
            <option value="Solved">Solved</option>
            <option value="Complete">Complete</option>
          </select>
        </label>
      </div>
      <button type="button" class="btn" (click)="addClient()">+ Add Client</button>
    </section>

    <div *ngIf="errorMessage" class="alert alert-error">{{ errorMessage }}</div>
    <div *ngIf="successMessage" class="alert alert-success">{{ successMessage }}</div>

    <div class="actions">
      <button type="submit" class="btn primary" [disabled]="isSubmitting">
        {{ isSubmitting ? 'Submitting...' : 'Submit Report' }}
      </button>
    </div>
  </form>
</div>

